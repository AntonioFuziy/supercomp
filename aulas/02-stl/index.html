


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://insper.github.io/supercomp/aulas/02-stl/">
      
      
        <meta name="author" content="Igor Montagner, Lucianos Soares">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.1">
    
    
      
        <title>02 - Templates e STL - 7s - SuperComputação - Insper 2020/1</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a676eddb.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.b302131d.min.css">
      
      
        
        
        <meta name="theme-color" content="#757575">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/printing.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="grey" data-md-color-accent="red">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#02-templates-e-stl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      











<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->

<script>
  window.site_url = "https://insper.github.io/supercomp/";
</script>

<div class="md-printing-header">
  <img class="cabecalho" src="https://insper.github.io/supercomp/css/cabecalho.png">
  <img class="logo" src="https://insper.github.io/supercomp/css/logo.png">

  <div class="frontmatter">
    <div class="materia"> SuperComputação </div>
    <div class="professor"> Igor Montagner, Luciano Soares </div>
    <div class="semestre"> 2020/1 </div>
  </div>
</div>

<header class="md-header" data-md-component="header">

  <!-- Top-level navigation -->
  <nav class="md-header-nav md-grid" aria-label="Header">

    <!-- Link to home -->
    <a
      href="https://insper.github.io/supercomp/"
      title="7s - SuperComputação - Insper 2020/1"
      class="md-header-nav__button md-logo"
      aria-label="7s - SuperComputação - Insper 2020/1"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>

    <!-- Header title -->
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            7s - SuperComputação - Insper 2020/1
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              02 - Templates e STL
            
          </span>
        </div>
      
    </div>

    <!-- Button to open search dialogue -->
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>

      <!-- Search interface -->
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository containing source -->
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/insper/supercomp/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
      </div>
    
  </nav>
</header>




    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://insper.github.io/supercomp/" title="7s - SuperComputação - Insper 2020/1" class="md-nav__button md-logo" aria-label="7s - SuperComputação - Insper 2020/1">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    7s - SuperComputação - Insper 2020/1
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/insper/supercomp/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../sobre/" title="Sobre" class="md-nav__link">
      Sobre
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Aulas
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Aulas" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Aulas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../00-organizacao/" title="Organização do repositório" class="md-nav__link">
      Organização do repositório
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01-intro-cpp/" title="01 - Introdução a C++" class="md-nav__link">
      01 - Introdução a C++
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        02 - Templates e STL
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="02 - Templates e STL" class="md-nav__link md-nav__link--active">
      02 - Templates e STL
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#smart-pointers" class="md-nav__link">
    Smart Pointers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings-e-vector" class="md-nav__link">
    Strings e Vector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projeto-0-adicionando-stl" class="md-nav__link">
    Projeto 0 - adicionando STL
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03-cmake/" title="03 - CMake e Debugging no VSCode" class="md-nav__link">
      03 - CMake e Debugging no VSCode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04-autovec/" title="04 - SIMD: Autovetorização" class="md-nav__link">
      04 - SIMD: Autovetorização
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05-intro-multi-core/" title="05 - Introdução a multi-core" class="md-nav__link">
      05 - Introdução a multi-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06-intro-openmp/" title="06 - Introdução a OpenMP" class="md-nav__link">
      06 - Introdução a OpenMP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07-openmp-for/" title="07 - OpenMP: Construções de alto nível" class="md-nav__link">
      07 - OpenMP: Construções de alto nível
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08-efeitos-colaterais/" title="08 - Efeitos colaterais" class="md-nav__link">
      08 - Efeitos colaterais
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09-tarefas/" title="09 - Tarefas" class="md-nav__link">
      09 - Tarefas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10-gpu-I/" title="10 - introdução a GPU" class="md-nav__link">
      10 - introdução a GPU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../11-gpu-II/" title="11 - introdução a GPU - II" class="md-nav__link">
      11 - introdução a GPU - II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../12-gpu-III/" title="12 - introdução a GPU - III" class="md-nav__link">
      12 - introdução a GPU - III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13-gpu-rand/" title="13 - Números aleatórios em GPU" class="md-nav__link">
      13 - Números aleatórios em GPU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../14-gpu-rand-II/" title="14 - Mais números aleatórios em GPU" class="md-nav__link">
      14 - Mais números aleatórios em GPU
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Projetos
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Projetos" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Projetos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/" title="Índice" class="md-nav__link">
      Índice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/projeto-pfe/" title="Alocação de alunos para o PFE" class="md-nav__link">
      Alocação de alunos para o PFE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/checklist/" title="Requisitos básicos de projeto" class="md-nav__link">
      Requisitos básicos de projeto
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#smart-pointers" class="md-nav__link">
    Smart Pointers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings-e-vector" class="md-nav__link">
    Strings e Vector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projeto-0-adicionando-stl" class="md-nav__link">
    Projeto 0 - adicionando STL
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/insper/supercomp/edit/master/docs/aulas/02-stl.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1 id="02-templates-e-stl">02 - Templates e STL<a class="headerlink" href="#02-templates-e-stl" title="Permanent link">&para;</a></h1>
<p>Esta prática consiste primariamente em aprender a usar tipos de dados complexos 
disponibilizados pela STL e pela biblioteca padrão de C++. A atividade principal desta prática 
consiste em modificar o exercício da aula passada para usar as estruturas de dados e 
funções da STL. </p>
<h2 id="smart-pointers">Smart Pointers<a class="headerlink" href="#smart-pointers" title="Permanent link">&para;</a></h2>
<p>Uma das grandes dificuldades de desenvolver em C++ é evitar vazamentos de memória (memory leaks). Durante o desenvolvimento do programa é muito usado o recurso de alocação dinâmica de memória, contudo da mesma forma que o programador tem a responsabilidade de alocar a memória, ele tem de desalocar a memória. Os smart pointers são uma estratégia de evitar que você esqueça de desalocar e crie um programa devorador de memória. Os smart pointers percebem que uma memória alocada não é mais acessível e desaloca a memória.</p>
<p><strong>unique_ptr</strong>: um smart pointer para um único objeto com um dono só. Ou seja, este smart pointer aponta para um objeto que deve ter só um apontamento de cada vez. Ao realizarmos atribuições a variável "dono" do objeto muda. </p>
<p><strong>shared_ptr</strong>: Um smart pointer para um único objeto e pode ter vários donos. Ou seja, este smart pointer aponta para um objeto que pode ter vários apontamentos de cada vez. Ao realizarmos atribuições adicionamos uma nova referência a este dado. Quando não existem mais referências o dado é automaticamente liberado usando <code>delete</code></p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>O programa abaixo (<em>tarefa1.cpp</em>) tem problemas de memória devido a alocação feita na função <code>cria_vetor</code> e não liberada a cada iteração do for. Conserte o programa usando <code>shared_ptr</code> para que a memória alocada por <code>cria_vetor</code> seja liberada automaticamente. 
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="kt">double</span> <span class="o">*</span><span class="nf">cria_vetor</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">prt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">processa</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Hello!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">double</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">cria_vetor</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
        <span class="n">processa</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
        <span class="c1">// vetor não é deletado no fim do main!</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
<h2 id="strings-e-vector">Strings e Vector<a class="headerlink" href="#strings-e-vector" title="Permanent link">&para;</a></h2>
<p>Nesta seção iremos trabalhar com dois conteiners muito usados da STL: <a href="http://www.cplusplus.com/reference/string/">string</a> e <a href="http://www.cplusplus.com/reference/vector/vector/">vector</a>. O objetivo é acostumá-los a consultar a documentação de C++ e entendê-la com autonomia. A STL tem uma quantidade enorme de recursos e aprender a pesquisar como usá-los é importante para sua proficiência. </p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Faça um programa que lê uma linha de texto (usando <code>std::getline</code>) e procure nela todas as ocorrências da palavra "hello". Você deverá implementar uma função</p>
<p><code>std::vector&lt;int&gt; find_all(std::string text, std::string term);</code> </p>
<p>que devolve um vetor com a posição de todas as ocorrências de <code>term</code> em <code>text</code>. Sua função <code>main</code> deverá mostrar os resultados da busca de maneira bem formatada. </p>
</div>
<h2 id="projeto-0-adicionando-stl">Projeto 0 - adicionando STL<a class="headerlink" href="#projeto-0-adicionando-stl" title="Permanent link">&para;</a></h2>
<p>O código produzido na última aula parece muito com código <em>C</em> e usa muito pouco dos recursos introduzidos em <em>C++</em> para tornar nossos programas mais legíveis e fáceis de escrever. </p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Modifique sua função <code>gera_vetor</code> para usar <code>std::vector</code> ao invés de arrays puros e para usar o cabeçalho <code>&lt;random&gt;</code>. A distribuição usada deverá ser uniforme real com limites 5 a 27.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Modifique todas as funções (<code>log</code>, <code>sqrt</code>, <code>pow3</code>, <code>pow3mult</code> e <code>sum</code>) para receber <code>std::vector</code>. Note que você não precisa mais receber como argumento o tamanho do vetor. </p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Qual deverá ser a assinatura das funções acima para evitar que ocorra cópia do <code>std::vector</code>?</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Continuando o exercício acima, use iteradores para percorrer seu <code>std::vector</code>. Para deixar o código mais legível use <code>auto</code></p>
</div>
<p>Vamos agora trabalhar com programação funcional em <em>C++</em> para tornar nosso código menor: armazenamento de referências para funções em variáveis e definição de funções usando <code>lambda</code>. </p>
<p>Podemos definir funções no meio de nosso programa usando a seguinte sintaxe:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="o">&amp;|=</span><span class="p">]</span> <span class="p">(</span><span class="n">argumentos</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">retorno</span> <span class="p">{</span>
    <span class="n">corpo</span> <span class="n">da</span> <span class="n">função</span> <span class="n">aqui</span>
<span class="p">};</span>
</code></pre></div>

<p>Uma função definida desta maneira pode usar as variáveis locais disponíveis no momento em que ela foi declarada (mesmo que não sejam passadas como argumento). A primeira parte da declaração define se essas variáveis serão copiadas <code>[=]</code> ou se uma referência para elas será utilizada na função <code>[&amp;]</code>. O restante segue padrões normalmente usados em <em>C++</em>. </p>
<p>Podemos inclusive, passar essas funções como argumentos e devolvê-las como resultado de funções. Para isto usamos o tipo <code>std::function</code> disponível no cabeçalho <code>functional</code>. Os exercícios abaixo foram extraídos do arquivo <code>exemplos-lambda.cpp</code>. Faça-os e cheque seus resultados rodando o programa. Se houver dúvida chame o professor. </p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Qual é o resultado do código abaixo?</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">by_two</span> <span class="o">=</span> <span class="p">[</span><span class="o">=</span><span class="p">](</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kt">double</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">;</span> 
<span class="p">};</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">by_two</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</code></pre></div>

</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Qual é o resultado do código abaixo?</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">by_c</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kt">double</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">;</span> 
<span class="p">};</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">by_c</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">by_c</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</code></pre></div>

</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Escreva abaixo o tipo de uma variável que guarda referência para as funções que testamos neste exercício</p>
<ul>
<li><code>log</code></li>
<li><code>sqrt</code></li>
<li><code>pow3</code></li>
<li><code>pow3mult</code></li>
<li><code>sum</code></li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Crie uma função <code>std::vector&lt;double&gt; teste_incremental(</code><strong>tipo aqui</strong><code>)</code> que recebe um ponteiro para o tipo das funções acima e executa a função recebida com tamanhos de vetores incrementalmente maiores. Sua função deverá devolver os tempos (em segundos) para todas as execuções feitas. Ou seja, a função teste_incremental deverá funcionar como uma "casquinha" que gera vetores, roda as funções matemáticas testadas e retorna seus tempos de execução.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>você deve ter notado que a função <code>sum</code> não possui a mesma assinatura das outras. Use uma função <code>lambda</code> para adaptar os tipos e usar a função acima para testar a função <code>sum</code> também. </p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../01-intro-cpp/" title="01 - Introdução a C++" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                01 - Introdução a C++
              </div>
            </div>
          </a>
        
        
          <a href="../03-cmake/" title="03 - CMake e Debugging no VSCode" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                03 - CMake e Debugging no VSCode
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.c51dfa35.min.js"></script>
      <script src="../../assets/javascripts/bundle.eaaa3931.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../translate-admonitions.js"></script>
      
    
  </body>
</html>