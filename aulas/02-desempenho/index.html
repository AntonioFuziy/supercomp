
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://insper.github.io/supercomp/aulas/02-desempenho/">
      
      
        <meta name="author" content="Igor Montagner, Lucianos Soares">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.0">
    
    
      
        <title>02 - Iniciando C++11 - SuperComputação - 2020/2</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bc7e593a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab28b872.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/printing.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="grey" data-md-color-accent="red">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#02-iniciando-c11" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      











<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->

<script>
  window.site_url = "https://insper.github.io/supercomp/";
</script>

<div class="md-printing-header">
  <img class="cabecalho" src="https://insper.github.io/supercomp/css/cabecalho.png">
  <img class="logo" src="https://insper.github.io/supercomp/css/logo.png">

  <div class="frontmatter">
    <div class="materia"> SuperComputação </div>
    <div class="professor"> Igor Montagner, Luciano Soares </div>
    <div class="semestre"> 2020/2 </div>
  </div>
</div>

<header class="md-header" data-md-component="header">

  <!-- Top-level navigation -->
  <nav class="md-header-nav md-grid" aria-label="Header">

    <!-- Link to home -->
    <a
      href="https://insper.github.io/supercomp/"
      title="SuperComputação - 2020/2"
      class="md-header-nav__button md-logo"
      aria-label="SuperComputação - 2020/2"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            SuperComputação - 2020/2
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              02 - Iniciando C++11
            
          </span>
        </div>
      
    </div>

    <!-- Button to open search dialogue -->
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>

      <!-- Search interface -->
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository containing source -->
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/insper/supercomp/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
      </div>
    
  </nav>
</header>




    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://insper.github.io/supercomp/" title="SuperComputação - 2020/2" class="md-nav__button md-logo" aria-label="SuperComputação - 2020/2">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    SuperComputação - 2020/2
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/insper/supercomp/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../sobre/" class="md-nav__link">
      Burocracias
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Aulas
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Aulas" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Aulas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01-introducao/" class="md-nav__link">
      01 - Aquecimento
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        02 - Iniciando C++11
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      02 - Iniciando C++11
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#alocacao-de-memoria-e-vetores-em-c" class="md-nav__link">
    Alocação de memória e vetores em C++
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrizes-versao-1" class="md-nav__link">
    Matrizes (versão 1)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias-e-passagem-de-dados" class="md-nav__link">
    Referências e passagem de dados
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uma-primeira-otimizacao" class="md-nav__link">
    Uma primeira otimização
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03-profiling-e-projeto/" class="md-nav__link">
      03 - Profiling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04-projeto-heuristicas/" class="md-nav__link">
      04 - Heurísticas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05-algoritmos-aleatorios/" class="md-nav__link">
      05 - Algoritmos Aleatorizados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06-busca-local/" class="md-nav__link">
      06 - Busca local
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07-busca-exaustiva/" class="md-nav__link">
      07 - Busca exaustiva
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08-busca-exaustiva-II/" class="md-nav__link">
      08 - Comparação de resultados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09-branch-and-bound/" class="md-nav__link">
      09 - Branch and Bound
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10-branch-and-bound-II/" class="md-nav__link">
      10 - Branch and Bound II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../11-introducao-paralelismo/" class="md-nav__link">
      11 - Introdução a paralelismo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../12-introducao-omp/" class="md-nav__link">
      12 - Introdução a OpenMP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13-paralelismo-dados/" class="md-nav__link">
      13 - Paralelismo de dados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../14-efeitos-colaterais/" class="md-nav__link">
      14 - Efeitos colaterais
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../15-exercicio/" class="md-nav__link">
      15 - Exercício prático
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Projeto
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Projeto" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Projeto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/" class="md-nav__link">
      Travelling Sales Person (TSP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/checklist/" class="md-nav__link">
      Checklist de projeto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/heuristica/" class="md-nav__link">
      Heurística da cidade mais próxima
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/busca-local/" class="md-nav__link">
      Busca local
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/busca-exaustiva/" class="md-nav__link">
      Busca exaustiva
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/desempenho-sequencial/" class="md-nav__link">
      Desempenho sequencial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/multi-core/" class="md-nav__link">
      Paralelismo multi-core
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#alocacao-de-memoria-e-vetores-em-c" class="md-nav__link">
    Alocação de memória e vetores em C++
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrizes-versao-1" class="md-nav__link">
    Matrizes (versão 1)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias-e-passagem-de-dados" class="md-nav__link">
    Referências e passagem de dados
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uma-primeira-otimizacao" class="md-nav__link">
    Uma primeira otimização
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/insper/supercomp/edit/master/docs/aulas/02-desempenho/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="02-iniciando-c11">02 - Iniciando C++11<a class="headerlink" href="#02-iniciando-c11" title="Permanent link">&para;</a></h1>
<p>Nesta aula trabalharemos dois objetivos:</p>
<ol>
<li>implementação de algoritmos dada uma descrição de alto nível da tarefa a ser implementada</li>
<li>técnicas de implementação para alto desempenho</li>
</ol>
<h2 id="alocacao-de-memoria-e-vetores-em-c">Alocação de memória e vetores em C++<a class="headerlink" href="#alocacao-de-memoria-e-vetores-em-c" title="Permanent link">&para;</a></h2>
<p>Em <em>C</em> usamos as funções <code>malloc</code> e <code>free</code> para alocar memória dinamicamente. Um inconveniente dessas funções é que sempre temos que passar o tamanho que queremos em bytes. Em <em>C++</em> essas funções também estão disponíveis, mas usá-las é considerado uma má prática. Ao invés, usamos os operadores <code>new</code> e <code>delete</code> para alocar memória. Existem duas vantagens em usá-los.</p>
<ol>
<li>Podemos escrever diretamente o tipo que queremos, em vez de seu tamanho em bytes. </li>
<li>A alocação de arrays é feita de maneira natural usando os colchetes <code>[]</code>.</li>
</ol>
<p>Vejamos o exemplo abaixo. </p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">double</span> <span class="o">*</span><span class="n">values</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>

<span class="cm">/* usar values aqui */</span>

<span class="k">delete</span><span class="p">[]</span> <span class="n">values</span><span class="p">;</span>
</code></pre></div>
<p>É alocado um vetor de <code>double</code> de tamanho <code>n</code> (lido do terminal). Após ele ser usado liberamos o espaço alocado usando <code>delete[]</code>. </p>
<div class="admonition tip">
<p class="admonition-title">E se eu quiser alocar um só valor?</p>
<p>É simples! É só usar <code>new</code> sem os colchetes <code>[]</code>!</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Crie um programa que lê um número inteiro <code>n</code> e depois lê <code>n</code> números fracionários <span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span>. Faça os seguintes cálculos e motre-os no terminal com 10 casas decimais. </p>
<div>
<div class="MathJax_Preview">\mu = \frac{1}{n} \sum_{i=1}^n x_i</div>
<script type="math/tex; mode=display">\mu = \frac{1}{n} \sum_{i=1}^n x_i</script>
</div>
<div>
<div class="MathJax_Preview">\sigma^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \mu)^2</div>
<script type="math/tex; mode=display">\sigma^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \mu)^2</script>
</div>
<details class="details"><summary>Resposta</summary><p>Use o programa <code>t1.py</code> para gerar entradas e saídas de teste para seu programa. </p>
</details>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Você reconhece as fórmulas acima? Elas calculam quais medidas estatísticas?</p>
<details class="details"><summary>Resposta</summary><p>Média e variância.</p>
</details>
</div>
<p>Apesar do uso de <code>new[]</code> e <code>delete[]</code> mostrado na seção anterior já ser mais conveniente, ainda são essencialmente um programa em C com sintaxe ligeiramente mais agradável. Para tornar a programação em C++ mais produtiva sua biblioteca padrão conta com estruturas de dados prontas para uso. </p>
<p>A estrutura <code>std::vector</code> é um vetor dinâmico que tem funcionalidades parecidas com a lista de Python ou o <code>ArrayList</code> de Java. O código abaixo exemplifica seu uso e mostra algumas de suas funções. Note que omitimos o uso de <code>std</code> no código abaixo.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Tamanho do vetor: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Primeiro elemento: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Último elemento: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Elemento 3: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</code></pre></div>
<p>Alguns pontos interessantes deste exemplo:</p>
<ol>
<li>Não sabemos o tamanho de <code>vec</code> ao criá-lo. O método <code>push_back</code> aumenta ele quando necessário e não precisamos nos preocupar com isso. </li>
<li>O número de elementos colocados no vetor é retornado pelo método <code>size()</code></li>
<li>O acesso é feito exatamente igual ao array de C, usando os colchetes <code>[]</code></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">E esse <code>&lt;double&gt;</code> na declaração?</p>
<p>Em C++ tipos passados entre <code>&lt; &gt;</code> são usados para parametrizar tipos genéricos. Ou seja, um vetor pode guardar qualquer tipo de dado e precisamos indicar qual ao criá-lo. </p>
<p>Note que, portanto, um vetor <code>vector&lt;int&gt;</code> e um vetor <code>vector&lt;double&gt;</code> são considerados de tipos diferentes e não posso passar o primeiro para uma função esperando o segundo. </p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Modifique sua Tarefa 4 para usar <code>vector</code>. Verifique que o programa continua produzindo os mesmos resultados. </p>
</div>
<h2 id="matrizes-versao-1">Matrizes (versão 1)<a class="headerlink" href="#matrizes-versao-1" title="Permanent link">&para;</a></h2>
<p>Dados <code>N</code> pontos com coordenadas <span><span class="MathJax_Preview">(x_i, y_i)_{i=0}^N</span><script type="math/tex">(x_i, y_i)_{i=0}^N</script></span>, computar a matriz de distâncias <span><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span> tal que </p>
<div>
<div class="MathJax_Preview">
D_{i,j} = \textrm{Distância entre } (x_i, y_i) \textrm{ e } (x_j, y_j)
</div>
<script type="math/tex; mode=display">
D_{i,j} = \textrm{Distância entre } (x_i, y_i) \textrm{ e } (x_j, y_j)
</script>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use <code>t3.py</code> para gerar os arquivos de entrada/saída da tarefa abaixo. </p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Implemente um programa que calcule a matriz <code>D</code> acima. Sua entrada deverá estar no formato dos arquivos <code>t3-in-*.txt</code> e sua saída no formato dos arquivos <code>t3-out-*.txt</code>. Mostre as distâncias com 2 casas decimais.  </p>
<p><strong>Dicas</strong>:</p>
<ol>
<li>a maneira mais fácil (não necessariamente a melhor) de alocar uma matriz é usando um vetor em que cada elemento é outro vetor. </li>
<li>faça uma implementação o mais simples possível. Vamos melhorá-la nas próximas tarefas.</li>
</ol>
<details class="details"><summary>Resposta</summary><div class="highlight"><pre><span></span><code>leia inteiro N
leia vetores X e Y 

seja D uma matriz NxN

para i=1..N:
    para j=1..N:
        DX = X[i] - X[j]
        DY = Y[i] - Y[j]
        D[i,j] = sqrt(DX*DX + DY*DY)
</code></pre></div>
</details>
</div>
<div class="admonition question medium">
<p class="admonition-title">Question</p>
<p>Anote abaixo o tempo de execução para os arquivos <code>t3-in-*.txt</code> e <code>t3-out-*.txt</code></p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Qual é a complexidade computacional de sua implementação? </p>
</div>
<h2 id="referencias-e-passagem-de-dados">Referências e passagem de dados<a class="headerlink" href="#referencias-e-passagem-de-dados" title="Permanent link">&para;</a></h2>
<p>Na parte anterior fizemos nosso programa inteiro no <code>main</code>. Vamos agora organizá-lo melhor. </p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Crie uma função <code>calcula_distancias</code> que recebe a matriz e os dados recebidos na entrada e a preenche. Sua função não deverá retornar nenhum valor. </p>
<p>Ao terminar, meça o tempo de execução para o arquivo <code>t3-out-4.txt</code>.</p>
<details class="details"><summary>Resposta</summary><p>Aqui podem ocorrer dois problemas:</p>
<ol>
<li>Seu programa deu "Segmentation Fault". </li>
<li>Seu programa rodou até o fim, mas a saída é vazia (ou cheia de 0).</li>
</ol>
<p>O problema em si depende de como você fez o <code>for</code> duplo para mostrar os resultados. De qualquer maneira, simplesmente mover código para uma outra função não funciona neste caso. </p>
</details>
</div>
<p>Ambos problemas descritos na solução são previsíveis e ocorrem pela mesma razão: <strong>ao passar um <code>vector</code> para uma função é feita uma cópia de seu conteúdo</strong>. Ou seja, a matriz usada dentro de <code>calcula_distancias</code> não é a mesma do <code>main</code>! </p>
<p>Isto é considerado uma <em>feature</em> em <code>C++</code>: por padrão toda variável é passada <strong>por cópia</strong>. Isto evita que uma função modifique um valor sem que o código chamador fique sabendo. </p>
<p>Em <em>C</em> podemos passar variáveis <strong>por referência</strong> passando um ponteiro para elas. Apesar de funcional, isso não é muito prático pois temos que acessar a variável sempre usando <code>*</code>.  Em <em>C++</em> temos um novo recurso: referências. Ao declarar uma variável como uma referência crio uma espécie de <em>ponteiro constante</em> que sempre acessa a variável apontada. Veja o exemplo abaixo.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="o">&amp;</span><span class="n">ref</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="c1">// referências são declaradas colocando &amp; na frente do nome da variável</span>
<span class="c1">// a partir daqui ref e x representam a mesma variável</span>
<span class="n">ref</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span> <span class="c1">// 15</span>
</code></pre></div>
<p>O mesmo poderia ser feito com ponteiros (como mostrado abaixo). A grande vantagem da referência é que não precisamos usar <code>*ref</code> para nos referirmos à variável <code>x</code>! Na atribuição também podemos usar direto <code>int &amp;ref = x</code>, o que torna o código mais limpo e fácil de entender.  </p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="o">*</span><span class="n">ref</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">;</span> <span class="c1">// precisamos de &amp;x para apontar ref para a variável x</span>
<span class="o">*</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span> <span class="c1">// precisamos indicar *ref para atribuir a variável x</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span> <span class="c1">// 15</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Dicas</p>
<p>Note que uma referência tem que ser inicializada com a variável a que ela se refere. Ou seja, ao declarar tenho que já indicar a variável destino. </p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Modifique sua função para usar referências. Verifique que ele volta a funcionar e que seu tempo de execução continua parecido com a versão que rodava no <code>main</code>.</p>
<details class="details"><summary>Resposta</summary><p>Basta adicionar <code>&amp;</code> na frente dos nomes dos argumentos (vetores x, y e matriz). A chamada da função não muda. </p>
</details>
</div>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Em <em>C++</em> precisamos estar sempre atentos a maneira que passamos os dados. Se não indicarmos será por cópia. Para compartilhar o mesmo objeto entre várias funções usamos referências <code>&amp;</code>. </p>
</div>
<h2 id="uma-primeira-otimizacao">Uma primeira otimização<a class="headerlink" href="#uma-primeira-otimizacao" title="Permanent link">&para;</a></h2>
<p>Nossa primeira implementação é bastante direta da definição e não tenta ser eficiente. </p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Analisando a definiçao da Tarefa 1, como seria possível economizar trabalho?</p>
<details class="details"><summary>Resposta</summary><p>Podemos ver que a matriz <code>D</code> é simétrica. Ou seja, <code>D[i,j] == D[j,i]</code>. Isso significa que poderíamos calcular só um deles e copiar o valor para a outra posição.</p>
</details>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Como isso poderia ser usado para melhorar o tempo de execução de <code>calcula_distancias</code>?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Seu programa criado na tarefa 1 consegue ser adaptado para implementar sua ideia da questão 
anterior? O que precisaria ser modificado?</p>
<details class="note"><summary>Resposta</summary><p>Duas respostas são possíveis e corretas aqui:</p>
<ol>
<li>
<p>Preciso checar se o <code>i &gt; j</code> e usar o valor já calculado de <code>D[j,i]</code>.</p>
</li>
<li>
<p>É preciso alocar a matriz inteira antes de começar. Se formos dando <code>push_back</code> linha a linha não conseguimos atribuir um valor ao mesmo tempo a <code>D[i,j]</code> e <code>D[j,i]</code>, já que um deles ainda não terá sido criado. </p>
</li>
</ol>
</details>
</div>
<p>Baseado na resposta acima vamos tentar nossa primeira otimização: só vamos calcular <code>D[i,j]</code> para <code>i &lt;= j</code> (ou seja, só a metade "de cima" de <code>D</code>).</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Use a estratégia acima para evitar calcular a matriz inteira. Verifique se houve melhora no tempo do teste <code>t3-in-3.txt</code>.</p>
<p><strong>Dica</strong>: tente de novo usar a ideia mais simples possível e implemente adicionando um so <code>if</code> no seu programa.</p>
<details class="details"><summary>Resposta</summary><div class="codehilite"><pre><span></span><code>Não deverá haver ganho de desempenho significativo. Veremos exatamente o por que na próxima aula.
</code></pre></div>

</details>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../01-introducao/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                01 - Aquecimento
              </div>
            </div>
          </a>
        
        
          <a href="../03-profiling-e-projeto/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                03 - Profiling
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.6a3d08fc.min.js"></script>
      <script src="../../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../translate-admonitions.js"></script>
      
    
  </body>
</html>